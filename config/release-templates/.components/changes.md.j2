{%    from 'macros.common.j2' import apply_alphabetical_ordering_by_descriptions
%}{%  from 'macros.common.j2' import emoji_map, render_special_section
%}{%  from 'macros.md.j2' import format_commit_summary_line
%}{#
EXAMPLE:

### âœ¨ Features

- Add new feature ([#10](https://domain.com/namespace/repo/pull/10),
  [`abcdef0`](https://domain.com/namespace/repo/commit/HASH))

- **scope**: Add new feature ([`abcdef0`](https://domain.com/namespace/repo/commit/HASH))

### ðŸª² Bug Fixes

- Fix bug ([#11](https://domain.com/namespace/repo/pull/11),
  [`abcdef1`](https://domain.com/namespace/repo/commit/HASH))

### ðŸ’¥ Breaking Changes

- With the change _____, the change causes ___ effect. Ultimately, this section
  it is a more detailed description of the breaking change. With an optional
  scope prefix like the commit messages above.

- **scope**: this breaking change has a scope to identify the part of the code that
  this breaking change applies to for better context.

### ðŸ’¡ Additional Release Information

- This is a release note that provides additional information about the release
  that is not a breaking change or a feature/bug fix.

- **scope**: this release note has a scope to identify the part of the code that
  this release note applies to for better context.

#}{%  set max_line_width = max_line_width | default(100)
%}{%  set hanging_indent = hanging_indent | default(2)
%}{#
#}{%  for type_, commits in commit_objects if type_ != "unknown"
%}{#    PREPROCESS COMMITS (order by description & format description line)
#}{%    set ns = namespace(commits=commits)
%}{%    set _ = apply_alphabetical_ordering_by_descriptions(ns)
%}{#
#}{%    set commit_descriptions = []
%}{#
#}{%    for commit in ns.commits
%}{#      # Add reference links to the commit summary line
#}{%      set description = "- %s" | format(format_commit_summary_line(commit))
%}{%      set description = description | autofit_text_width(max_line_width, hanging_indent)
%}{%      set _ = commit_descriptions.append(description)
%}{%    endfor
%}{#
   #    # PRINT SECTION (header & commits)
#}{%    if commit_descriptions | length > 0
%}{{      "\n"
}}{{      "### %s %s\n" | format(emoji_map[type_], type_ | title)
}}{{      "\n"
}}{{      "%s\n" | format(commit_descriptions | unique | join("\n\n"))
}}{%    endif
%}{%  endfor
%}{#
      # Render breaking changes section (if any commits have breaking_descriptions)
#}{{  render_special_section(
        commit_objects,
        'breaking_descriptions.0',
        'breaking_descriptions.0',
        'breaking_descriptions',
        'Breaking Changes',
        'breaking',
        max_line_width,
        hanging_indent
      )
}}{#
      # Render release notices section (if any commits have release_notices)
#}{{  render_special_section(
        commit_objects,
        'release_notices.0',
        'release_notices.0',
        'release_notices',
        'Additional Release Information',
        'release_note',
        max_line_width,
        hanging_indent
      )
}}
